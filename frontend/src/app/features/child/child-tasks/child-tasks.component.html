<div class="container mx-auto p-4">
  <div class="bg-white rounded-lg shadow-md p-6">
    <h1 class="text-2xl font-bold mb-6 text-purple-800">My Tasks</h1>

    <!-- Loading Spinner -->
    <div *ngIf="loading$ | async" class="flex justify-center">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <!-- Tasks List -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <mat-card *ngFor="let task of tasks$ | async" class="task-card">
        <mat-card-header>
          <mat-card-title>{{ task.title }}</mat-card-title>
          <div class="mt-2">
            <mat-chip-set>
              <mat-chip [ngClass]="getTaskStatusClass(task.status)">
                {{ task.status }}
              </mat-chip>
            </mat-chip-set>
          </div>
        </mat-card-header>
        <mat-card-content>
          <p>{{ task.description }}</p>
          <p class="points">Points: {{ task.pointValue }}</p>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-raised-button
            color="primary"
            (click)="viewTask(task)"
            [disabled]="task.status === TaskStatus.COMPLETED"
          >
            {{ task.status === TaskStatus.COMPLETED ? "Completed" : "Answer" }}
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>

<!-- Answer Dialog -->
<div *ngIf="selectedTask" class="dialog-overlay">
  <mat-dialog-content class="dialog-content">
    <h2>Answer Task: {{ selectedTask.title }}</h2>
    <p>{{ selectedTask.description }}</p>
    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Your Answer</mat-label>
      <textarea matInput [(ngModel)]="answer" rows="4"></textarea>
    </mat-form-field>
    <div class="dialog-actions">
      <button mat-button (click)="selectedTask = null">Cancel</button>
      <button
        mat-raised-button
        color="primary"
        (click)="submitAnswer()"
        [disabled]="!answer.trim()"
      >
        Submit Answer
      </button>
    </div>
  </mat-dialog-content>
</div>
