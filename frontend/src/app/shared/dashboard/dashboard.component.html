<!-- dashboard.component.html -->
<div class="dashboard-layout flex h-screen overflow-hidden bg-gray-50">
  <!-- Sidebar -->
  <aside
    [ngClass]="{ 'w-64': sidebarOpen, 'w-20': !sidebarOpen }"
    class="transition-all duration-300 ease-in-out bg-gradient-to-b from-[#3f0d71] to-[#5a189a] text-white shadow-lg flex flex-col h-screen"
  >
    <!-- Sidebar Header -->
    <div class="p-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-2" *ngIf="sidebarOpen">
          <mat-icon class="white">person</mat-icon>
          <span class="font-bold text-lg">Compagnon</span>
        </div>
        <div *ngIf="!sidebarOpen" class="flex justify-center w-full">
          <mat-icon class="white">person</mat-icon>
        </div>
        <button mat-icon-button (click)="toggleSidebar()" class="text-white">
          <mat-icon>{{
            sidebarOpen ? "chevron_left" : "chevron_right"
          }}</mat-icon>
        </button>
      </div>
    </div>

    <!-- Sidebar Navigation -->
    <nav class="flex-1 mt-5 px-2 overflow-y-auto">
      <!-- Admin Navigation -->
      <div *ngIf="userRole === 'ADMIN'">
        <a
          routerLink="/dashboard"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>dashboard</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Dashboard</span>
        </a>
        <a
          routerLink="/users"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>people</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">User Management</span>
        </a>
        <a
          routerLink="/task-types"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>category</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Task Types</span>
        </a>
        <a
          routerLink="/statistics"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon class="accent">bar_chart</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Statistics</span>
        </a>
      </div>

      <!-- Parent Navigation -->
      <div *ngIf="userRole === 'PARENT'">
        <a
          routerLink="/dashboard"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon class="accent">dashboard</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Dashboard</span>
        </a>
        <a
          routerLink="/children"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon class="accent">child_care</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">My Children</span>
        </a>
        <a
          routerLink="/tasks"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon class="accent">assignment</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Tasks</span>
        </a>
        <a
          routerLink="/rewards"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon class="accent">card_giftcard</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">Rewards</span>
        </a>
      </div>

      <!-- Child Navigation -->
      <div *ngIf="userRole === 'CHILD'">
        <a
          routerLink="/dashboard"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>dashboard</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">My Dashboard</span>
        </a>
        <a
          routerLink="/my-tasks"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>check_circle</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">My Tasks</span>
        </a>
        <a
          routerLink="/my-rewards"
          routerLinkActive="bg-[#7b2cbf] text-white"
          class="flex items-center px-4 py-3 text-white hover:bg-[#7b2cbf] rounded-md transition-colors mb-1"
        >
          <mat-icon>emoji_events</mat-icon>
          <span *ngIf="sidebarOpen" class="ml-3">My Rewards</span>
        </a>
      </div>
    </nav>

    <!-- Sidebar Footer -->
    <div class="p-4 border-t border-[#7b2cbf]">
      <div
        class="flex items-center px-4 py-3 text-white hover:bg-accent rounded-md transition-colors cursor-pointer"
        (click)="logout()"
      >
        <mat-icon class="accent">exit_to_app</mat-icon>
        <span *ngIf="sidebarOpen" class="ml-3">Logout</span>
      </div>
    </div>
  </aside>

  <!-- Main Content - Scrollable -->
  <div class="flex-1 flex flex-col min-h-screen">
    <!-- Top Header - Fixed -->
    <header class="bg-white shadow-sm z-10 sticky top-0">
      <div class="px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
        <div class="flex items-center">
          <button
            mat-icon-button
            (click)="toggleSidebar()"
            class="md:hidden text-[#3f0d71]"
          >
            <mat-icon>menu</mat-icon>
          </button>
          <h1 class="text-xl font-semibold text-gray-900 ml-2">Dashboard</h1>
        </div>

        <div class="flex items-center space-x-4">
          <div class="flex items-center">
            <mat-icon class="text-accent mr-2">verified_user</mat-icon>
            <span class="text-sm font-medium text-gray-700">{{
              userRole
            }}</span>
          </div>

          <!-- Points display for CHILD -->
          <div class="flex items-center" *ngIf="userRole === 'CHILD'">
            <mat-icon class="text-accent mr-2">stars</mat-icon>
            <span class="text-sm font-medium text-purple-600"
              >{{ user?.points || 0 }} Points</span
            >
          </div>

          <span class="text-sm text-gray-500 hidden md:inline">{{
            currentDate | date : "fullDate"
          }}</span>
        </div>
      </div>
    </header>

    <!-- Dashboard Content - Scrollable -->
    <main class="flex-1 overflow-y-auto bg-gray-50 p-4 sm:p-6 lg:p-8">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>
